# QR-EMS (QR-code Equipment Management System)

**QR-EMS** æ˜¯ä¸€å¥—ç¾ä»£åŒ–çš„è¨­å‚™è³‡ç”¢ç®¡ç†è§£æ±ºæ–¹æ¡ˆï¼Œå°ˆç‚ºè§£æ±ºå¯¦é©—å®¤ã€è¾¦å…¬å®¤æˆ–å…±äº«ç©ºé–“ä¸­è¨­å‚™è¿½è¹¤ä¸æ˜“ã€å€Ÿé‚„æµç¨‹ç¹ç‘£çš„å•é¡Œè€Œè¨­è¨ˆã€‚

é€éæ•´åˆ **QR Code å¿«é€Ÿæƒæ**æŠ€è¡“ï¼Œä½¿ç”¨è€…åƒ…éœ€ä½¿ç”¨æ‰‹æ©Ÿæˆ– WebCam æƒæè¨­å‚™ä¸Šçš„æ¨™ç±¤ï¼Œå³å¯å¿«é€Ÿæª¢è¦–è¨­å‚™è©³æƒ…ã€ç‹€æ…‹æˆ–é€²è¡Œå€Ÿé‚„æ“ä½œã€‚ç³»çµ±å…§å»ºå®Œæ•´çš„**æ¬Šé™ç®¡ç†**ï¼ˆAdmin/Manager/Userï¼‰èˆ‡**ç°½æ ¸æµç¨‹**ï¼Œä¸¦æ¡ç”¨ **Docker** å…¨å®¹å™¨åŒ–éƒ¨ç½²èˆ‡ **Cloudflare Tunnel** å®‰å…¨ç©¿é€æŠ€è¡“ï¼Œè®“ç®¡ç†è€…ç„¡éœ€ç¹é›œçš„ç¶²è·¯è¨­å®šï¼Œå³å¯è¼•é¬†åœ¨ä»»ä½•åœ°é»æŒæ¡è³‡ç”¢å‹•æ…‹ã€‚

---

## ğŸš€ æ ¸å¿ƒåŠŸèƒ½ (Key Features)

### ğŸ“¦ æ™ºæ…§è³‡ç”¢ç®¡ç†
*   **å…¨æ–¹ä½ç‹€æ…‹è¿½è¹¤**ï¼šå³æ™‚æŒæ¡è¨­å‚™ç‹€æ…‹ï¼ˆå¯å€Ÿç”¨ã€å·²å€Ÿå‡ºã€ç¶­è­·ä¸­ã€éºå¤±...ï¼‰ã€‚
*   **è©³ç´°è³‡ç”¢å±¥æ­·**ï¼šå®Œæ•´è¨˜éŒ„æ¯ä¸€æ¬¡çš„å€Ÿç”¨ã€æ­¸é‚„ã€ç¶­è­·èˆ‡è³‡æ–™è®Šæ›´ï¼Œæ–¹ä¾¿è³‡ç”¢ç›¤é»èˆ‡è¿½æº¯ã€‚
*   **å¤šå…ƒè¨­å‚™åˆ†é¡**ï¼šæ”¯æ´ç­†é›»ã€é¡¯ç¤ºå™¨ã€é–‹ç™¼æ¿ã€ç·šæã€å®¶å…·ç­‰å¤šç¨®è‡ªè¨‚é¡åˆ¥ã€‚
*   **éˆæ´»ç¯©é¸èˆ‡æœå°‹**ï¼šæä¾›å„€è¡¨æ¿å³æ™‚ç¯©é¸èˆ‡åˆ†é åŠŸèƒ½ï¼Œå¿«é€Ÿæ‰¾åˆ°ç›®æ¨™è¨­å‚™ã€‚

### ğŸ“± QR Code æƒææ•´åˆ
*   **ä¸€éµæƒæ**ï¼šæ”¯æ´è¡Œå‹•è£ç½®ç›¸æ©Ÿæˆ–é›»è…¦ WebCam æƒæï¼Œç›´æ¥è·³è½‰è‡³è¨­å‚™å°ˆå±¬é é¢ã€‚
*   **å³æ™‚ç”Ÿæˆ**ï¼šæ¯é …è¨­å‚™è‡ªå‹•ç”Ÿæˆå°ˆå±¬ QR Codeï¼Œå¯ç›´æ¥åˆ—å°è²¼æ–¼å¯¦é«”è¨­å‚™ä¸Šã€‚

### ğŸ›¡ï¸ å®‰å…¨èˆ‡æ¬Šé™
*   **OAuth èº«åˆ†é©—è­‰**ï¼šæ•´åˆ **Google ç™»å…¥**ï¼Œæ”¯æ´ JWT é©—è­‰ï¼Œäº¦æä¾›å‚³çµ±å¸³è™Ÿå¯†ç¢¼è¨»å†ŠåŠŸèƒ½ã€‚
*   **è§’è‰²æ¬Šé™åˆ†ç´š**ï¼š
    *   **Admin (ç®¡ç†å“¡)**ï¼šç³»çµ±å…¨æ¬Šç®¡ç†ã€è§’è‰²åˆ†é…ã€‚
    *   **Manager (ç¶“ç†)**ï¼šè¨­å‚™ç®¡ç†ã€å¯©æ ¸æ­¸é‚„ç”³è«‹ã€‚
    *   **User (ä½¿ç”¨è€…)**ï¼šç€è¦½è¨­å‚™ã€å€Ÿç”¨ç”³è«‹ã€‚
*   **æ­¸é‚„å¯©æ ¸æ©Ÿåˆ¶**ï¼šé˜²æ­¢èª¤æ“ä½œï¼Œæ­¸é‚„éœ€ç¶“ç”±ç®¡ç†äººå“¡å¯©æ ¸ï¼ˆæ‰¹å‡†/æ‹’çµ•ï¼‰å¾Œæ‰ç®—å®Œæˆã€‚

### ğŸ—ï¸ ç¾ä»£åŒ–æŠ€è¡“æ¶æ§‹
*   **Backend:** Python 3.12, Django 6, Django REST Framework (DRF), PostgreSQL.
*   **Frontend:** React 18, TypeScript, Vite, Tailwind CSS.
*   **DevOps:** Docker Compose å…¨ç«¯å®¹å™¨åŒ–, Cloudflare Tunnel (Zero Trust) å…¬ç¶²ç©¿é€.

---

## ğŸ› ï¸ å®‰è£èˆ‡å•Ÿå‹• (Setup & Run)

### 1. ç’°å¢ƒæº–å‚™
ç¢ºä¿æ‚¨çš„ç³»çµ±å·²å®‰è£ä»¥ä¸‹å·¥å…·ï¼š
*   **Docker** & **Docker Compose**
*   **Make** (å¯é¸ï¼Œç”¨æ–¼ç°¡åŒ–æŒ‡ä»¤)

### 2. è¨­å®šç’°å¢ƒè®Šæ•¸
è«‹è¤‡è£½ç¯„ä¾‹è¨­å®šæª”ä¸¦å¡«å…¥æ‚¨çš„åƒæ•¸ï¼š

```bash
# 1. æ ¹ç›®éŒ„ (Docker & Cloudflare è¨­å®š)
cp .env.example .env
# æç¤º: è‹¥ä½¿ç”¨ Cloudflare Dashboard ç®¡ç† Tunnelï¼Œè«‹å¡«å…¥ TUNNEL_TOKEN

# 2. å¾Œç«¯è¨­å®š (Django & DB)
cp backend/.env.example backend/.env
# é‡è¦: ä¿®æ”¹ FRONTEND_URL ç‚ºæ‚¨çš„å…¬é–‹ç¶²å€ (ä¾‹å¦‚ https://qrems.example.com)

# 3. å‰ç«¯è¨­å®š (React & Vite)
cp frontend/.env.example frontend/.env
# é‡è¦: å¡«å…¥ VITE_GOOGLE_CLIENT_ID (éœ€å¾ Google Cloud Console ç”³è«‹)
```

### 3. å•Ÿå‹•æœå‹™
ä½¿ç”¨ `make` æŒ‡ä»¤ä¸€éµå•Ÿå‹•æ‰€æœ‰æœå‹™ï¼š

```bash
make build  # å»ºç½® Docker Images
make up     # å•Ÿå‹•æ‰€æœ‰æœå‹™ (Backend, Frontend, DB, Tunnel)
```

æœå‹™å•Ÿå‹•å¾Œï¼Œæ‚¨å¯é€éä»¥ä¸‹ç¶²å€è¨ªå•ï¼š
*   **Frontend (ä½¿ç”¨è€…ä»‹é¢):** `http://localhost:5173` (æˆ–æ‚¨çš„ Cloudflare å…¬ç¶²ç¶²å€)
*   **Backend API:** `http://localhost:8000/api/v1/`
*   **Admin Panel:** `http://localhost:8000/admin/`

### 4. å»ºç«‹ç®¡ç†å“¡ (Superuser)
åœ¨å®¹å™¨é‹è¡Œç‹€æ…‹ä¸‹ï¼ŒåŸ·è¡Œä»¥ä¸‹æŒ‡ä»¤å»ºç«‹æœ€é«˜æ¬Šé™å¸³è™Ÿï¼š

```bash
docker-compose exec backend python manage.py createsuperuser
```

### 5. ç”Ÿæˆæ¸¬è©¦è³‡æ–™ (å¯é¸)
è‹¥éœ€å¿«é€Ÿé«”é©—ç³»çµ±ï¼Œå¯ç”Ÿæˆéš¨æ©Ÿçš„è¨­å‚™èˆ‡åˆ†é¡è³‡æ–™ï¼š

```bash
docker-compose exec backend python generate_test_data.py
```
> **æ³¨æ„**ï¼šæ­¤è…³æœ¬æœƒæ¸…ç©ºç¾æœ‰è¨­å‚™è³‡æ–™è¡¨ã€‚

---

## â˜ï¸ Cloudflare Tunnel è¨­å®šæŒ‡å—

æœ¬å°ˆæ¡ˆå…§å»º `cloudflared` å®¹å™¨ï¼Œæ–¹ä¾¿æ‚¨å°‡æœ¬åœ°æœå‹™æš´éœ²è‡³å…¬ç¶²ã€‚

**æ–¹å¼ A: Dashboard ç®¡ç† (æ¨è–¦)**
1.  ç™»å…¥ [Cloudflare Zero Trust Dashboard](https://one.dash.cloudflare.com/) å»ºç«‹ä¸€å€‹æ–°çš„ Tunnelã€‚
2.  è¤‡è£½å–å¾—çš„ Tokenï¼Œå¡«å…¥æ ¹ç›®éŒ„ `.env` æª”æ¡ˆä¸­çš„ `TUNNEL_TOKEN` æ¬„ä½ã€‚
3.  åœ¨ Dashboard çš„ Public Hostname é ç±¤è¨­å®šï¼š
    *   **Public Hostname**: `YOUR_DOMAIN` (ä¾‹å¦‚ qrems.raylei-lab.com)
    *   **Service**: `http://frontend:5173`

**æ–¹å¼ B: CLI ç®¡ç† (æœ¬åœ° Config)**
1.  å°‡æ‚¨çš„ `tunnel_creds.json` å’Œ `tunnel_config.yml` æ”¾å…¥å°ˆæ¡ˆæ ¹ç›®éŒ„ã€‚
2.  ç¢ºèª `docker-compose.yml` ä¸­ `tunnel` æœå‹™å·²æ­£ç¢ºæ›è¼‰é€™äº›è¨­å®šæª”ã€‚

---

## ğŸ“‚ å°ˆæ¡ˆçµæ§‹æ¦‚è¦½

```text
/
â”œâ”€â”€ backend/            # Django Backend
â”‚   â”œâ”€â”€ apps/           # æ¥­å‹™é‚è¼¯æ¨¡çµ„
â”‚   â”‚   â”œâ”€â”€ equipment/  # è¨­å‚™ç®¡ç† (Models, Views)
â”‚   â”‚   â”œâ”€â”€ transactions/ # å€Ÿé‚„äº¤æ˜“ç´€éŒ„
â”‚   â”‚   â””â”€â”€ users/      # ä½¿ç”¨è€…èˆ‡é©—è­‰
â”‚   â””â”€â”€ Dockerfile
â”œâ”€â”€ frontend/           # React Frontend
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ api/        # API ä¸²æ¥å±¤
â”‚   â”‚   â”œâ”€â”€ components/ #å…±ç”¨å…ƒä»¶
â”‚   â”‚   â”œâ”€â”€ pages/      # ä¸»è¦é é¢ (Dashboard, Scan, Admin...)
â”‚   â”‚   â””â”€â”€ types/      # TypeScript å‹åˆ¥å®šç¾©
â”‚   â””â”€â”€ Dockerfile
â”œâ”€â”€ docker-compose.yml  # å®¹å™¨ç·¨æ’è¨­å®š
â”œâ”€â”€ Makefile            # å¸¸ç”¨æŒ‡ä»¤é›†
â””â”€â”€ tunnel_config.yml   # Cloudflare Tunnel è¨­å®šç¯„æœ¬
```

## ğŸ“ é–‹ç™¼æŒ‡å¼• (Development)

*   **æ–°å¢å¥—ä»¶ä¾è³´:**
    *   **Backend:** `cd backend && uv add <package>` (æ–°å¢å¾Œè«‹é‡æ–° `make build`)
    *   **Frontend:** `cd frontend && pnpm add <package>`
*   **è³‡æ–™åº«é·ç§» (Migrations):**
    Backend å®¹å™¨å•Ÿå‹•æ™‚æœƒè‡ªå‹•åŸ·è¡Œ migrateã€‚è‹¥æ‚¨ä¿®æ”¹äº† Models ä¸¦éœ€å»ºç«‹æ–°çš„ migration æª”ï¼š
    ```bash
    docker-compose exec backend python manage.py makemigrations
    ```

## ğŸ“„ æˆæ¬Š (License)
MIT License