# é–‹ç™¼è¦ç¯„èˆ‡æ¨™æº– (Development Standards)

ç‚ºäº†ç¶­æŒ QR-EMS å°ˆæ¡ˆçš„ç©©å®šæ€§èˆ‡å¯ç¶­è­·æ€§ï¼Œæ‰€æœ‰é–‹ç™¼è€…è«‹éµå®ˆä»¥ä¸‹è¦ç¯„ã€‚

## ğŸ› ï¸ é–‹ç™¼å·¥å…·è¦æ±‚

| å·¥å…·åç¨± | ç‰ˆæœ¬è¦æ±‚ | ç”¨é€” |
| :--- | :--- | :--- |
| **Docker Compose** | V2 (æŒ‡ä»¤ `docker compose`) | å®¹å™¨åŒ–æœå‹™ç·¨æ’ï¼Œç¢ºä¿ç”Ÿç”¢èˆ‡é–‹ç™¼ç’°å¢ƒä¸€è‡´ |
| **Devbox** | æœ€æ–°ç‰ˆ | éš”é›¢é–‹ç™¼ç’°å¢ƒ (æ²™ç›’)ï¼Œæ›¿ä»£å‚³çµ± venv |
| **pnpm** | v10+ | å‰ç«¯é«˜æ•ˆèƒ½å¥—ä»¶ç®¡ç† |
| **uv** | æœ€æ–°ç‰ˆ | å¾Œç«¯æ¥µé€Ÿ Python å¥—ä»¶èˆ‡ç’°å¢ƒç®¡ç† |

---

## ğŸ“¦ æ²™ç›’é–‹ç™¼ç’°å¢ƒ (Devbox) - å¼·çƒˆæ¨è–¦

ç‚ºäº†ç¢ºä¿é–‹ç™¼ç’°å¢ƒéš”é›¢ä¸”ä¸æ±™æŸ“ç³»çµ±ï¼Œå»ºè­°ä½¿ç”¨ Devboxã€‚

### ğŸš€ å¦‚ä½•é–‹å§‹
1.  **å®‰è£ Devbox**: åŸ·è¡Œ `curl -fsSL https://get.jetify.com/devbox | bash`ã€‚
2.  **é€²å…¥æ²™ç›’**: åœ¨å°ˆæ¡ˆæ ¹ç›®éŒ„åŸ·è¡Œ `devbox shell`ã€‚
3.  **åˆå§‹åŒ–å°ˆæ¡ˆ**: åŸ·è¡Œ `run setup` (è‡ªå‹•è·‘ uv sync èˆ‡ pnpm install)ã€‚

### âš¡ é–‹ç™¼æŒ‡ä»¤ (æ²™ç›’å…§)
*   **å•Ÿå‹•å¾Œç«¯**: `run dev-back` æˆ– `cd backend && uv run python manage.py runserver`ã€‚
*   **å•Ÿå‹•å‰ç«¯**: `run dev-front` æˆ– `cd frontend && pnpm dev`ã€‚
*   **åŸ·è¡Œæ¸¬è©¦**: `run test`ã€‚

---

## ğŸ¨ å‰ç«¯é–‹ç™¼è¦ç¯„ (Frontend)

### 1. å‹åˆ¥å®‰å…¨æ€§ (TypeScript)
*   **ç¦æ­¢ä½¿ç”¨ `any`:** è«‹å„ªå…ˆä½¿ç”¨å…·é«”å‹åˆ¥æˆ– `unknown`ã€‚
*   **è™•ç† Nullable æ¬„ä½:** å¾å¾Œç«¯ API ç²å–çš„æ¬„ä½ï¼ˆå¦‚ä½ç½®ã€æè¿°ï¼‰é€šå¸¸ç‚º `null`ï¼Œä»‹é¢å®šç¾©æ‡‰åŒ…å« `| null` ä¸¦åœ¨ UI ä¸­è™•ç†ç©ºå€¼ã€‚
*   **éåŒæ­¥æ¸¬è©¦:** æ’°å¯«å–®å…ƒæ¸¬è©¦æ™‚ï¼Œè‹¥è¦ Mock API å›å‚³å€¼ï¼Œè«‹ä½¿ç”¨ `Awaited<ReturnType<typeof apiFunc>>`ã€‚

### 2. React Hooks è¦å‰‡
*   **é¿å…åŒæ­¥æ¸²æŸ“:** åœ¨ `useEffect` å…§ç¦æ­¢ç›´æ¥å‘¼å«æœƒè§¸ç™¼é‡ç¹ªçš„åŒæ­¥ `setState`ã€‚è‹¥æœ‰å¿…è¦ï¼Œè«‹ä½¿ç”¨ `setTimeout(() => ..., 0)` å°‡å…¶è½‰ç‚ºç•°æ­¥ï¼Œæˆ–è€ƒæ…®é‡æ§‹é‚è¼¯ã€‚

### 3. åœ–ç¤ºå¼•ç”¨
*   æ‰€æœ‰åœ–ç¤ºå¿…é ˆçµ±ä¸€å¾ `lucide-react` å¼•å…¥ã€‚

## ğŸ å¾Œç«¯é–‹ç™¼è¦ç¯„ (Backend)

### 1. è³‡æ–™åº«æ“ä½œ
*   **æ˜ç¢ºæ’åº:** æ‰€æœ‰ ViewSet çš„ `queryset` å¿…é ˆåŒ…å« `.order_by()`ï¼Œä»¥é¿å… Django çš„åˆ†é è­¦å‘Š `UnorderedObjectListWarning`ã€‚
*   **äº¤æ˜“åŸå­æ€§:** æ¶‰åŠå¤šå€‹ Model è®Šæ›´çš„é‚è¼¯æ‡‰å°è£åœ¨ `transaction.atomic()` å¡Šä¸­ã€‚

### 2. æ¸¬è©¦è¦ç¯„
*   **æ¬„ä½èªæ„:** `Transaction` æ¨¡å‹ä¸­ï¼Œ`reason` æ˜¯ä½¿ç”¨è€…å¡«å¯«çš„ç”³è«‹ç†ç”±ï¼Œ`admin_note` æ˜¯ç®¡ç†å“¡å¡«å¯«çš„å¯©æ ¸å‚™è¨»ã€‚æ¸¬è©¦ç”¨ä¾‹æ‡‰åš´æ ¼å€åˆ†ã€‚
*   **ç’°å¢ƒä¸€è‡´æ€§:** åŸ·è¡Œæ¸¬è©¦è«‹å„ªå…ˆä½¿ç”¨ `make test-back`ï¼ˆåœ¨ Docker å…§é‹è¡Œï¼‰ã€‚

## ğŸŒ¿ Git æµç¨‹

### 1. Commit è¨Šæ¯
*   è¨Šæ¯è«‹ä½¿ç”¨ **ä¸­æ–‡** æˆ–ç¬¦åˆ **Conventional Commits** è¦ç¯„ã€‚
*   ç¯„ä¾‹ï¼š`fix: ä¿®å¾©è¨­å‚™è©³æƒ…é çš„å‹åˆ¥éŒ¯èª¤` æˆ– `feat: æ–°å¢æƒæç¢ºèªåŠŸèƒ½`ã€‚

### 2. æäº¤å‰æª¢æŸ¥
*   æäº¤å‰è«‹å‹™å¿…åŸ·è¡Œï¼š
    *   å‰ç«¯ï¼š`pnpm lint` èˆ‡ `pnpm test`
    *   å¾Œç«¯ï¼š`make test-back`

---

## ğŸ§ª API æ‰‹å‹•æ¸¬è©¦æŒ‡å— (Manual Testing)

è‹¥æ‚¨å¸Œæœ›ä½¿ç”¨ Postman æˆ– Curl ç›´æ¥æ¸¬è©¦å¾Œç«¯ APIï¼Œè«‹éµå¾ªä»¥ä¸‹æ­¥é©Ÿé€²è¡Œé©—è­‰ã€‚

### 1. ç²å– Access Token
å¾Œç«¯æ¡ç”¨ JWT é©—è­‰ã€‚è«‹å…ˆå‘ `/api/v1/auth/token/` ç™¼é€ POST è«‹æ±‚ä»¥å–å¾— Tokenã€‚

*   **URL:** `http://localhost:8000/api/v1/auth/token/`
*   **Method:** `POST`
*   **Body (JSON):**
    ```json
    {
      "username": "admin",
      "password": "your_password"
    }
    ```
*   **Response:**
    ```json
    {
      "refresh": "eyJ0eX...",
      "access": "eyJ0eX..."  // <--- é€™æ˜¯æˆ‘å€‘è¦çš„ Token
    }
    ```

### 2. è¨­å®š Authorization Header
åœ¨å¾ŒçºŒçš„æ‰€æœ‰è«‹æ±‚ä¸­ (å¦‚æŸ¥è©¢è¨­å‚™ã€å€Ÿé‚„ç”³è«‹)ï¼Œå¿…é ˆåœ¨ Header å¸¶ä¸Š Tokenï¼š

*   **Header Name:** `Authorization`
*   **Header Value:** `Bearer <ä½ çš„_Access_Token>`
    *   æ³¨æ„ `Bearer` èˆ‡ Token ä¹‹é–“æœ‰ä¸€å€‹ç©ºæ ¼ã€‚

### 3. å¸¸è¦‹æ¸¬è©¦æƒ…å¢ƒ
*   **æŸ¥è©¢æ‰€æœ‰è¨­å‚™:** `GET /api/v1/equipment/`
*   **æƒæä¸¦å€Ÿå‡ºè¨­å‚™:** `POST /api/v1/transactions/borrow/`
    ```json
    {
      "equipment_uuid": "è¨­å‚™çš„UUID",
      "reason": "å°ˆæ¡ˆé–‹ç™¼æ¸¬è©¦ä½¿ç”¨"
    }
    ```

